CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

SET(PROJECT_NAME SCRCAPI)

PROJECT(${PROJECT_NAME} VERSION 0.1.0 LANGUAGES CXX)

SET(CMAKE_CXX_STANDARD 17)
SET(CMAKE_CXX_STANDARD_REQUIRED TRUE)

FIND_PACKAGE(CURL REQUIRED)
FIND_PACKAGE(PkgConfig REQUIRED)
pkg_check_modules(JSONCPP jsoncpp)

FILE(GLOB_RECURSE SRC_FILES "${CMAKE_SOURCE_DIR}/src/*.cxx")

ADD_LIBRARY(${PROJECT_NAME} ${SRC_FILES})
TARGET_INCLUDE_DIRECTORIES(${PROJECT_NAME} PRIVATE ${CMAKE_SOURCE_DIR}/include)
TARGET_LINK_LIBRARIES(${PROJECT_NAME} PUBLIC ${CURL_LIBRARIES})
TARGET_LINK_LIBRARIES(${PROJECT_NAME} PUBLIC ${JSONCPP_LIBRARIES})

FILE(GLOB_RECURSE EXAMPLE_SRCS ${CMAKE_SOURCE_DIR}/examples/*.cxx)

FOREACH(FILENAME ${EXAMPLE_SRCS})
    GET_FILENAME_COMPONENT(FILE_BIN ${FILENAME} NAME_WLE)
    ADD_EXECUTABLE(${FILE_BIN} ${FILENAME})
    TARGET_LINK_LIBRARIES(${FILE_BIN} PUBLIC ${PROJECT_NAME})
    TARGET_INCLUDE_DIRECTORIES(${FILE_BIN} PUBLIC ${CMAKE_SOURCE_DIR}/include)
    TARGET_LINK_LIBRARIES(${FILE_BIN} PUBLIC ${JSONCPP_LIBRARIES})
ENDFOREACH()